
create PROCEDURE [dbo].[uspGetDocumentType]                    
AS   
BEGIN
  select distinct(b.DOCUTYPE) from (
  SELECT      
  CASE WHEN A.TYPE  = 'application/vnd.openxmlformats-officedocument.spre'  THEN 'MS-EXCEL'  
  WHEN  A.TYPE  = 'application/vnd.ms-excel'  THEN 'MS-EXCEL'  
  WHEN  A.TYPE  = 'application/vnd.openxmlformats-officedocument.word'  THEN 'MS-WORD'  
  WHEN  A.TYPE  = 'application/msword'  THEN 'MS-WORD'  
  WHEN  A.TYPE  = 'image/png'  THEN 'IMAGE'  
  WHEN  A.TYPE  = 'image/gif'  THEN 'IMAGE'  
  WHEN  A.TYPE  = 'image/jpeg'  THEN 'IMAGE'  
  WHEN  A.TYPE  = 'application/pdf'  THEN 'PDF'  
  WHEN  A.TYPE  IS NULL  THEN 'IMAGE' 
  END AS DOCUTYPE
  from   [DBO].[UPLOADDOCUMENT] A)B                     
END 
GO
