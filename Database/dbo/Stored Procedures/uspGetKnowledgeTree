
CREATE PROCEDURE [dbo].[uspGetKnowledgeTree]      
AS                        
   BEGIN                        
SELECT       
CASE WHEN A.TYPE  = 'application/vnd.openxmlformats-officedocument.spre'  THEN 'MS-EXCEL'  
  WHEN  A.TYPE  = 'application/vnd.ms-excel'  THEN 'MS-EXCEL'  
  WHEN  A.TYPE  = 'application/vnd.openxmlformats-officedocument.word'  THEN 'MS-WORD'  
  WHEN  A.TYPE  = 'application/msword'  THEN 'MS-WORD'  
  WHEN  A.TYPE  = 'image/png'  THEN 'IMAGE'  
  WHEN  A.TYPE  = 'image/gif'  THEN 'IMAGE'  
  WHEN  A.TYPE  = 'image/jpeg'  THEN 'IMAGE'  
  WHEN  A.TYPE  = 'application/pdf'  THEN 'PDF'  
  WHEN  A.TYPE  IS NULL  THEN 'IMAGE'  
 END AS DOCUTYPE, 
 D.NAME AS CATEGORYNAME, 
 L.Name LOBName,  
A.ID AS DOCMENTID,   
A.NAME AS IMAGENAME,    
R.UserCode,    
R.UserName,    
A.TITLE , 
A.message as Tag
FROM [DBO].[UPLOADDOCUMENT] A     
JOIN [DBO].[KMTDOCUMENTCATEGORY] D ON A.CATEGORY= D.ID    
JOIN [dbo].[KMTUserRegistration] R ON R.ID=A.UPLOADBY   
JOIN [dbo].[KMTLob] L ON L.ID = R.LOBID   
WHERE A.Status=1
ORDER BY 3,1
END  
GO
