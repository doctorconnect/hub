
CREATE PROCEDURE [dbo].[uspSubmitKMTLob]  
( 
 @Id int,
 @CapId int, 			 
 @Name  VARCHAR(50),
 @IsActive bit,
 @CreatedBy VARCHAR(50),
 @CreatedOn date,
 @ModifiedBy VARCHAR(50),
 @ModifiedOn  date                    
)                                                      
AS                                                      
BEGIN        
    BEGIN TRANSACTION;      
      SAVE TRANSACTION MySavePoint;        
     BEGIN TRY  
	 if(@id=0) 
	 BEGIN               
    INSERT INTO KMTLob (CapId,NAME,Identifier,IsActive,CreatedBy,CreatedOn,ModifiedBy,ModifiedOn)
	   values (@CapId,@Name,'LINE OF BUSINESS',@IsActive,@CreatedBy,@CreatedOn,@ModifiedBy,@ModifiedOn);		
		END  
		ELSE if(@id>0)   
	 BEGIN               
    update KMTLob set NAME = @Name,ModifiedBy=@ModifiedBy,ModifiedOn=@ModifiedOn,CapId=@CapId,IsActive=@IsActive where Id = @id;
	END          			                    
     END TRY       
     BEGIN CATCH      
        IF @@TRANCOUNT > 0      
        BEGIN      
            ROLLBACK TRANSACTION MySavePoint;       
        END      
      END CATCH                                                 
     COMMIT TRANSACTION                                                  
END

GO
