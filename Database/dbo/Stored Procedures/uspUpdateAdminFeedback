
CREATE PROCEDURE [dbo].[uspUpdateAdminFeedback]  
( 
 @AdminCode VARCHAR(50), 
 @AdminNTID VARCHAR(50),
 @AdminName VARCHAR(50),
 @AdminEmail VARCHAR(50),
 @FeedbackId VARCHAR(50),  
 @FeedbackAnswer VARCHAR(500),  
 @ModifiedBy VARCHAR(50),  
 @ModifiedOn DATETIME  
)   
AS  
  BEGIN  
    BEGIN TRANSACTION;                  
     SAVE TRANSACTION MySavePoint;                    
      BEGIN TRY           
       UPDATE KMTFeedback 
	     SET AdminCode = @AdminCode,
		 AdminNTID = @AdminNTID,
		 AdminName = @AdminName,
		 AdminEmail = @AdminEmail,
		 AdminReply = @FeedbackAnswer,
		 ModifiedBy = @ModifiedBy, 
		 ModifiedOn = @ModifiedOn  
         WHERE FeedbackId = @FeedbackId   
      END TRY  
   BEGIN CATCH  
     IF @@TRANCOUNT > 0                  
        BEGIN                  
            ROLLBACK TRANSACTION MySavePoint;                   
        END            
      END CATCH            
    COMMIT TRANSACTION            
  END

GO
